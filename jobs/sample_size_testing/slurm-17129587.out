-----<sample size - ucf - scratch>-----
==============================   SLURM   ==============================
SLURM_MPI_TYPE                : pmix_v3
SLURM_NODEID                  : 0
SLURM_TASK_PID                : 2980494
SLURM_PRIO_PROCESS            : 0
SLURM_SUBMIT_DIR              : /lustre06/project/6061875/sdastani/SSL_video/jobs/sample_size_testing
SLURM_CPUS_PER_TASK           : 1
SLURM_PROCID                  : 0
SLURM_JOB_GID                 : 3121684
SLURMD_NODENAME               : ng10103
RSNT_SLURM_MPI_TYPE           : pmix_v3
SLURM_TASKS_PER_NODE          : 1
SLURM_NNODES                  : 1
SLURM_TMPDIR                  : /localscratch/sdastani.17129587.0
SLURM_NTASKS_PER_NODE         : 1
SLURM_JOB_NODELIST            : ng10103
SLURM_CLUSTER_NAME            : narval
SLURM_NODELIST                : ng10103
SLURM_GPUS_ON_NODE            : 1
SLURM_NTASKS                  : 1
SLURM_JOB_CPUS_PER_NODE       : 1
SLURM_TOPOLOGY_ADDR           : ihpc207u29.ihpc101u25.ng10103
SLURM_WORKING_CLUSTER         : narval:10.100.129.45:6817:9728:109
SLURM_JOB_NAME                : brats
SLURM_JOB_GPUS                : 0
SLURM_JOBID                   : 17129587
SLURM_CONF                    : /etc/slurm/slurm.conf
SLURM_NODE_ALIASES            : (null)
SLURM_JOB_QOS                 : normal
SLURM_TOPOLOGY_ADDR_PATTERN   : switch.switch.node
SLURM_CPUS_ON_NODE            : 1
SLURM_JOB_NUM_NODES           : 1
SLURM_MEM_PER_NODE            : 32768
SLURM_JOB_UID                 : 3121684
SLURM_JOB_PARTITION           : gpubase_bygpu_b3
SLURM_SCRIPT_CONTEXT          : prolog_task
SLURM_JOB_USER                : sdastani
SLURM_NPROCS                  : 1
SLURM_SUBMIT_HOST             : narval1.narval.calcul.quebec
SLURM_JOB_ACCOUNT             : rrg-ebrahimi_gpu
SLURM_GTIDS                   : 0
SLURM_RESTART_COUNT           : 0
SLURM_JOB_ID                  : 17129587
SLURM_LOCALID                 : 0
==============================   Config   ==============================
required_devices: 8
resume: False
no_test: False
test_only: False
debug: False
seed: 0
distributed: False
test_freq: 5
num_workers: 20
benchmark
  name: ucf101-full_finetune_1000_examples
dataset
  name: ucf101
  fold: 1
  batch_size: 32
  clip_duration: 2.0
  video_fps: 16.0
  crop_size: 112
  transform: msc+color
  min_area: 0.08
  normalize: True
  switch_channels: False
  num_of_examples: 1000
  color: [0.4, 0.4, 0.4, 0.2]
  train
    split: trainlist{fold:02d}
    mode: clip
    clips_per_video: 10
    use_augmentation: True
    use_shuffle: True
    drop_last: True
  test
    split: testlist{fold:02d}
    mode: clip
    clips_per_video: 5
    use_augmentation: False
    use_shuffle: False
    drop_last: False
  test_dense
    split: testlist{fold:02d}
    mode: video
    clips_per_video: 10
    use_augmentation: False
    use_shuffle: False
    drop_last: False
optimizer
  name: adam
  num_epochs: 16
  weight_decay: 0.0
  warmup_classifier: False
  lr
    name: multistep
    base_lr: 0.0001
    gamma: 0.3
    milestones: [6, 10, 14]
model
  args
    n_classes: 101
    feat_dim: 512
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::: Training from scratch :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
==============================   Parameters   ==============================
stem.0.weight                                                          | Trainable  | 45 x 3 x 1 x 7 x 7             | 6615
stem.1.weight                                                          | Trainable  | 45                             | 45
stem.1.bias                                                            | Trainable  | 45                             | 45
stem.3.weight                                                          | Trainable  | 64 x 45 x 3 x 1 x 1            | 8640
stem.4.weight                                                          | Trainable  | 64                             | 64
stem.4.bias                                                            | Trainable  | 64                             | 64
layer1.0.conv1.0.0.weight                                              | Trainable  | 144 x 64 x 1 x 3 x 3           | 82944
layer1.0.conv1.0.1.weight                                              | Trainable  | 144                            | 144
layer1.0.conv1.0.1.bias                                                | Trainable  | 144                            | 144
layer1.0.conv1.0.3.weight                                              | Trainable  | 64 x 144 x 3 x 1 x 1           | 27648
layer1.0.conv1.1.weight                                                | Trainable  | 64                             | 64
layer1.0.conv1.1.bias                                                  | Trainable  | 64                             | 64
layer1.0.conv2.0.0.weight                                              | Trainable  | 144 x 64 x 1 x 3 x 3           | 82944
layer1.0.conv2.0.1.weight                                              | Trainable  | 144                            | 144
layer1.0.conv2.0.1.bias                                                | Trainable  | 144                            | 144
layer1.0.conv2.0.3.weight                                              | Trainable  | 64 x 144 x 3 x 1 x 1           | 27648
layer1.0.conv2.1.weight                                                | Trainable  | 64                             | 64
layer1.0.conv2.1.bias                                                  | Trainable  | 64                             | 64
layer1.1.conv1.0.0.weight                                              | Trainable  | 144 x 64 x 1 x 3 x 3           | 82944
layer1.1.conv1.0.1.weight                                              | Trainable  | 144                            | 144
layer1.1.conv1.0.1.bias                                                | Trainable  | 144                            | 144
layer1.1.conv1.0.3.weight                                              | Trainable  | 64 x 144 x 3 x 1 x 1           | 27648
layer1.1.conv1.1.weight                                                | Trainable  | 64                             | 64
layer1.1.conv1.1.bias                                                  | Trainable  | 64                             | 64
layer1.1.conv2.0.0.weight                                              | Trainable  | 144 x 64 x 1 x 3 x 3           | 82944
layer1.1.conv2.0.1.weight                                              | Trainable  | 144                            | 144
layer1.1.conv2.0.1.bias                                                | Trainable  | 144                            | 144
layer1.1.conv2.0.3.weight                                              | Trainable  | 64 x 144 x 3 x 1 x 1           | 27648
layer1.1.conv2.1.weight                                                | Trainable  | 64                             | 64
layer1.1.conv2.1.bias                                                  | Trainable  | 64                             | 64
layer2.0.conv1.0.0.weight                                              | Trainable  | 230 x 64 x 1 x 3 x 3           | 132480
layer2.0.conv1.0.1.weight                                              | Trainable  | 230                            | 230
layer2.0.conv1.0.1.bias                                                | Trainable  | 230                            | 230
layer2.0.conv1.0.3.weight                                              | Trainable  | 128 x 230 x 3 x 1 x 1          | 88320
layer2.0.conv1.1.weight                                                | Trainable  | 128                            | 128
layer2.0.conv1.1.bias                                                  | Trainable  | 128                            | 128
layer2.0.conv2.0.0.weight                                              | Trainable  | 230 x 128 x 1 x 3 x 3          | 264960
layer2.0.conv2.0.1.weight                                              | Trainable  | 230                            | 230
layer2.0.conv2.0.1.bias                                                | Trainable  | 230                            | 230
layer2.0.conv2.0.3.weight                                              | Trainable  | 128 x 230 x 3 x 1 x 1          | 88320
layer2.0.conv2.1.weight                                                | Trainable  | 128                            | 128
layer2.0.conv2.1.bias                                                  | Trainable  | 128                            | 128
layer2.0.downsample.0.weight                                           | Trainable  | 128 x 64 x 1 x 1 x 1           | 8192
layer2.0.downsample.1.weight                                           | Trainable  | 128                            | 128
layer2.0.downsample.1.bias                                             | Trainable  | 128                            | 128
layer2.1.conv1.0.0.weight                                              | Trainable  | 288 x 128 x 1 x 3 x 3          | 331776
layer2.1.conv1.0.1.weight                                              | Trainable  | 288                            | 288
layer2.1.conv1.0.1.bias                                                | Trainable  | 288                            | 288
layer2.1.conv1.0.3.weight                                              | Trainable  | 128 x 288 x 3 x 1 x 1          | 110592
layer2.1.conv1.1.weight                                                | Trainable  | 128                            | 128
layer2.1.conv1.1.bias                                                  | Trainable  | 128                            | 128
layer2.1.conv2.0.0.weight                                              | Trainable  | 288 x 128 x 1 x 3 x 3          | 331776
layer2.1.conv2.0.1.weight                                              | Trainable  | 288                            | 288
layer2.1.conv2.0.1.bias                                                | Trainable  | 288                            | 288
layer2.1.conv2.0.3.weight                                              | Trainable  | 128 x 288 x 3 x 1 x 1          | 110592
layer2.1.conv2.1.weight                                                | Trainable  | 128                            | 128
layer2.1.conv2.1.bias                                                  | Trainable  | 128                            | 128
layer3.0.conv1.0.0.weight                                              | Trainable  | 460 x 128 x 1 x 3 x 3          | 529920
layer3.0.conv1.0.1.weight                                              | Trainable  | 460                            | 460
layer3.0.conv1.0.1.bias                                                | Trainable  | 460                            | 460
layer3.0.conv1.0.3.weight                                              | Trainable  | 256 x 460 x 3 x 1 x 1          | 353280
layer3.0.conv1.1.weight                                                | Trainable  | 256                            | 256
layer3.0.conv1.1.bias                                                  | Trainable  | 256                            | 256
layer3.0.conv2.0.0.weight                                              | Trainable  | 460 x 256 x 1 x 3 x 3          | 1059840
layer3.0.conv2.0.1.weight                                              | Trainable  | 460                            | 460
layer3.0.conv2.0.1.bias                                                | Trainable  | 460                            | 460
layer3.0.conv2.0.3.weight                                              | Trainable  | 256 x 460 x 3 x 1 x 1          | 353280
layer3.0.conv2.1.weight                                                | Trainable  | 256                            | 256
layer3.0.conv2.1.bias                                                  | Trainable  | 256                            | 256
layer3.0.downsample.0.weight                                           | Trainable  | 256 x 128 x 1 x 1 x 1          | 32768
layer3.0.downsample.1.weight                                           | Trainable  | 256                            | 256
layer3.0.downsample.1.bias                                             | Trainable  | 256                            | 256
layer3.1.conv1.0.0.weight                                              | Trainable  | 576 x 256 x 1 x 3 x 3          | 1327104
layer3.1.conv1.0.1.weight                                              | Trainable  | 576                            | 576
layer3.1.conv1.0.1.bias                                                | Trainable  | 576                            | 576
layer3.1.conv1.0.3.weight                                              | Trainable  | 256 x 576 x 3 x 1 x 1          | 442368
layer3.1.conv1.1.weight                                                | Trainable  | 256                            | 256
layer3.1.conv1.1.bias                                                  | Trainable  | 256                            | 256
layer3.1.conv2.0.0.weight                                              | Trainable  | 576 x 256 x 1 x 3 x 3          | 1327104
layer3.1.conv2.0.1.weight                                              | Trainable  | 576                            | 576
layer3.1.conv2.0.1.bias                                                | Trainable  | 576                            | 576
layer3.1.conv2.0.3.weight                                              | Trainable  | 256 x 576 x 3 x 1 x 1          | 442368
layer3.1.conv2.1.weight                                                | Trainable  | 256                            | 256
layer3.1.conv2.1.bias                                                  | Trainable  | 256                            | 256
layer4.0.conv1.0.0.weight                                              | Trainable  | 921 x 256 x 1 x 3 x 3          | 2121984
layer4.0.conv1.0.1.weight                                              | Trainable  | 921                            | 921
layer4.0.conv1.0.1.bias                                                | Trainable  | 921                            | 921
layer4.0.conv1.0.3.weight                                              | Trainable  | 512 x 921 x 3 x 1 x 1          | 1414656
layer4.0.conv1.1.weight                                                | Trainable  | 512                            | 512
layer4.0.conv1.1.bias                                                  | Trainable  | 512                            | 512
layer4.0.conv2.0.0.weight                                              | Trainable  | 921 x 512 x 1 x 3 x 3          | 4243968
layer4.0.conv2.0.1.weight                                              | Trainable  | 921                            | 921
layer4.0.conv2.0.1.bias                                                | Trainable  | 921                            | 921
layer4.0.conv2.0.3.weight                                              | Trainable  | 512 x 921 x 3 x 1 x 1          | 1414656
layer4.0.conv2.1.weight                                                | Trainable  | 512                            | 512
layer4.0.conv2.1.bias                                                  | Trainable  | 512                            | 512
layer4.0.downsample.0.weight                                           | Trainable  | 512 x 256 x 1 x 1 x 1          | 131072
layer4.0.downsample.1.weight                                           | Trainable  | 512                            | 512
layer4.0.downsample.1.bias                                             | Trainable  | 512                            | 512
layer4.1.conv1.0.0.weight                                              | Trainable  | 1152 x 512 x 1 x 3 x 3         | 5308416
layer4.1.conv1.0.1.weight                                              | Trainable  | 1152                           | 1152
layer4.1.conv1.0.1.bias                                                | Trainable  | 1152                           | 1152
layer4.1.conv1.0.3.weight                                              | Trainable  | 512 x 1152 x 3 x 1 x 1         | 1769472
layer4.1.conv1.1.weight                                                | Trainable  | 512                            | 512
layer4.1.conv1.1.bias                                                  | Trainable  | 512                            | 512
layer4.1.conv2.0.0.weight                                              | Trainable  | 1152 x 512 x 1 x 3 x 3         | 5308416
layer4.1.conv2.0.1.weight                                              | Trainable  | 1152                           | 1152
layer4.1.conv2.0.1.bias                                                | Trainable  | 1152                           | 1152
layer4.1.conv2.0.3.weight                                              | Trainable  | 512 x 1152 x 3 x 1 x 1         | 1769472
layer4.1.conv2.1.weight                                                | Trainable  | 512                            | 512
layer4.1.conv2.1.bias                                                  | Trainable  | 512                            | 512
fc.weight                                                              | Trainable  | 101 x 512                      | 51712
fc.bias                                                                | Trainable  | 101                            | 101

config {'name': 'adam', 'num_epochs': 16, 'weight_decay': 0.0, 'warmup_classifier': False, 'lr': {'name': 'multistep', 'base_lr': 0.0001, 'gamma': 0.3, 'milestones': [6, 10, 14]}}
==============================   Train DB   ==============================
original data length 9537
subset data 10 1000
1010 1010
False
UCF-101
 - Root: /home/sdastani/scratch/datasets/ucf101
 - Subset: trainlist01
 - Num videos: 1010
 - Num samples: 10100
 - Example video: /home/sdastani/scratch/datasets/ucf101/ApplyEyeMakeup/v_ApplyEyeMakeup_g08_c03.avi

==============================   Test DB   ==============================
False
UCF-101
 - Root: /home/sdastani/scratch/datasets/ucf101
 - Subset: testlist01
 - Num videos: 3783
 - Num samples: 18915
 - Example video: /home/sdastani/scratch/datasets/ucf101/ApplyEyeMakeup/v_ApplyEyeMakeup_g01_c01.avi

==============================   Dense DB   ==============================
False
UCF-101
 - Root: /home/sdastani/scratch/datasets/ucf101
 - Subset: testlist01
 - Num videos: 3783
 - Num samples: 37830
 - Example video: /home/sdastani/scratch/datasets/ucf101/ApplyEyeMakeup/v_ApplyEyeMakeup_g01_c01.avi


============================== Final evaluation ==============================
==============================   Train DB   ==============================
original data length 9537
subset data 10 1000
1010 1010
False
UCF-101
 - Root: /home/sdastani/scratch/datasets/ucf101
 - Subset: trainlist01
 - Num videos: 1010
 - Num samples: 10100
 - Example video: /home/sdastani/scratch/datasets/ucf101/ApplyEyeMakeup/v_ApplyEyeMakeup_g08_c03.avi

==============================   Test DB   ==============================
False
UCF-101
 - Root: /home/sdastani/scratch/datasets/ucf101
 - Subset: testlist01
 - Num videos: 3783
 - Num samples: 18915
 - Example video: /home/sdastani/scratch/datasets/ucf101/ApplyEyeMakeup/v_ApplyEyeMakeup_g01_c01.avi

==============================   Dense DB   ==============================
False
UCF-101
 - Root: /home/sdastani/scratch/datasets/ucf101
 - Subset: testlist01
 - Num videos: 3783
 - Num samples: 37830
 - Example video: /home/sdastani/scratch/datasets/ucf101/ApplyEyeMakeup/v_ApplyEyeMakeup_g01_c01.avi


test_dense: Epoch 16
/home/sdastani/env3.8/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/sdastani/env3.8/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
/home/sdastani/env3.8/lib/python3.8/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 20 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2023-05-21 17:11:21.432770 | test_dense [16][   1/1261]	Time 37.390 (37.390)	Data 33.166 (33.166)	Loss 6.1522e+00 (6.1522e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
2023-05-21 17:11:59.347887 | test_dense [16][ 100/1261]	Time  0.316 ( 0.753)	Data  0.000 ( 0.452)	Loss 4.5524e+00 (4.6956e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 ( 14.33)
2023-05-21 17:12:50.119845 | test_dense [16][ 200/1261]	Time  0.430 ( 0.508)	Data  0.000 ( 0.226)	Loss 5.1924e+00 (4.7674e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  7.17)
2023-05-21 17:13:51.438825 | test_dense [16][ 300/1261]	Time  0.266 ( 0.613)	Data  0.000 ( 0.321)	Loss 3.7727e+00 (4.7375e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  8.78)
2023-05-21 17:14:47.046798 | test_dense [16][ 400/1261]	Time  3.535 ( 0.556)	Data  3.221 ( 0.302)	Loss 6.1144e+00 (4.7870e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  6.58)
2023-05-21 17:15:37.735844 | test_dense [16][ 500/1261]	Time  0.298 ( 0.507)	Data  0.000 ( 0.239)	Loss 4.6120e+00 (4.7651e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  8.27)
2023-05-21 17:16:41.958482 | test_dense [16][ 600/1261]	Time  0.233 ( 0.642)	Data  0.000 ( 0.387)	Loss 4.1593e+00 (4.7875e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  6.89)
2023-05-21 17:17:35.821779 | test_dense [16][ 700/1261]	Time  0.372 ( 0.539)	Data  0.000 ( 0.283)	Loss 5.4006e+00 (4.7922e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  5.90)
2023-05-21 17:18:47.705407 | test_dense [16][ 800/1261]	Time  0.269 ( 0.719)	Data  0.000 ( 0.444)	Loss 5.5514e+00 (4.8139e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  5.17)
2023-05-21 17:19:53.476613 | test_dense [16][ 900/1261]	Time  0.255 ( 0.658)	Data  0.000 ( 0.381)	Loss 4.8796e+00 (4.7892e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  5.63)
2023-05-21 17:21:05.374766 | test_dense [16][1000/1261]	Time  0.482 ( 0.719)	Data  0.000 ( 0.438)	Loss 5.9834e+00 (4.8081e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  5.07)
2023-05-21 17:22:00.423648 | test_dense [16][1100/1261]	Time  0.306 ( 0.550)	Data  0.000 ( 0.264)	Loss 3.9493e+00 (4.8157e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  4.61)
2023-05-21 17:22:54.099825 | test_dense [16][1200/1261]	Time  0.221 ( 0.537)	Data  0.000 ( 0.287)	Loss 4.0566e+00 (4.8435e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  4.22)
2023-05-21 17:23:11.761586 | test_dense [16][1261/1261]	Time  0.152 ( 0.416)	Data  0.000 ( 0.188)	Loss 4.6495e+00 (4.8114e+00)	Acc@1   0.00 (  1.19)	Acc@5   0.00 (  5.21)

============================== Evaluation done ==============================
Video@1:   1.19
Video@MeanTop1:   0.99
Video@5:   5.21
Video@MeanTop5:   4.95
